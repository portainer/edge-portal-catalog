metadata:
  version: "1.0"
  updated: "2025-07-18T10:30:00Z"

defaults:
  source:
    git: "github.com/your-org/edge-templates"
    ref: "main"

apps:
  node-red:
    metadata:
      name: "Node-RED"
      description: "Low-code programming for event-driven applications"
      overview: "Node-RED is a flow-based development tool for visual programming developed originally by IBM for wiring together hardware devices, APIs and online services as part of the Internet of Things. It provides a browser-based flow editor that makes it easy to wire together flows using the wide range of nodes in the palette."
      publisher: "OpenJS Foundation"
      versions: ["3.1.14", "3.1.15", "4.0.9"]
      category: "industrial-automation"
      icon: "https://portainer-io-assets.sfo2.cdn.digitaloceanspaces.com/industrial-app-portal/logos/node-red.png"
      tags: ["automation", "low-code", "mqtt"]
      screenshots:
        - "https://portainer-io-assets.sfo2.cdn.digitaloceanspaces.com/industrial-app-portal/screenshots/node-red-1.jpeg"
      documentation: "https://docs.example.com/node-red"

    variants:
      - label: "Production"
        version_requirement: ">=3.1.15"
        deployment:
          compose:
            path: "apps/node-red/docker-compose.yml"
          kubernetes:
            path: "apps/node-red/kubernetes.yaml"
          helm:
            git: "github.com/your-org/helm-charts"
            ref: "v1.0.0"
            path: "node-red"
            chart: "node-red"
        configuration:
          files:
            - label: "Application Configuration"
              device_path: "/data/config.json"
              container_path: "/tmp/config.json"
              templates:
                production:
                  name: "Production Configuration"
                  description: "Production-ready Node-RED configuration with security and performance optimizations. Recommended for production deployments."
                  path: "apps/node-red/prod/config.json"
                development:
                  name: "Development Configuration"
                  description: "Development configuration with debug logging enabled and relaxed security. Use for testing and development only."
                  path: "apps/node-red/dev/config.json"
                minimal:
                  name: "Minimal Configuration"
                  description: "Minimal configuration with only essential settings. Good starting point for customization."
                  path: "apps/node-red/minimal/config.json"
              default: "production"
              locked: false
            - label: "MQTT Broker Configuration"
              device_path: "/data/mqtt.json"
              container_path: "/tmp/mqtt.json"
              templates:
                production:
                  name: "Production MQTT Broker"
                  description: "Production MQTT broker connection settings with TLS and authentication"
                  path: "apps/node-red/prod/mqtt.json"
                testing:
                  name: "Test MQTT Broker"
                  description: "Test environment MQTT broker (no TLS)"
                  path: "apps/node-red/test/mqtt.json"
              default: "production"
              locked: true
            - label: "Security Policy"
              device_path: "/data/security.json"
              container_path: "/app/security.json"
              templates:
                corporate:
                  name: "Corporate Security Policy"
                  description: "Mandatory security policy enforced by corporate IT. Cannot be modified."
                  path: "apps/node-red/security/corporate.json"
              locked: true
            - label: "SSL Certificate"
              device_path: "/data/certs/ssl.crt"
              container_path: "/app/certs/ssl.crt"
            - label: "SSH Private Key"
              device_path: "/data/.ssh/id_rsa"
              container_path: "/root/.ssh/id_rsa"
          variables:
            - name: "MQTT_BROKER"
              label: "MQTT Broker Address"
              default: "mqtt.example.com"
            - name: "MQTT_PORT"
              label: "MQTT Port"
              default: "1883"
            - name: "MQTT_USERNAME"
              label: "MQTT Username"
              default: "user"
            - name: "MQTT_PASSWORD"
              label: "MQTT Password"
      - label: "Testing"
        version_requirement: "<4.0.0"
        deployment:
          compose:
            git: "github.com/node-red/node-red-docker"
            ref: "main"
            path: "docker-compose.yml"
        configuration:
          files:
            - label: "Development Configuration"
              device_path: "/data/config.json"
              container_path: "/tmp/config.json"
              templates:
                development:
                  name: "Development Config"
                  description: "Debug mode enabled with verbose logging"
                  path: "apps/node-red/test/config.json"
          variables:
            - name: "DEBUG_MODE"
              label: "Enable Debug Mode"
              default: "true"
            - name: "LOG_LEVEL"
              label: "Log Level"
              default: "debug"
      - label: "Legacy (3.1.14 only)"
        version_requirement: "=3.1.14"
        deployment:
          compose:
            git: "github.com/node-red/node-red-docker"
            ref: "legacy"
            path: "docker-compose.yml"
      - label: "Environment Variables Only"
        version_requirement: ">=3.1.15"
        deployment:
          compose:
            path: "apps/node-red/docker-compose.yml"
        configuration:
          variables:
            - name: "NODE_ENV"
              label: "Node Environment"
              default: "production"
            - name: "LOG_LEVEL"
              label: "Log Level"
              default: "info"
            - name: "API_KEY"
              label: "API Key"

